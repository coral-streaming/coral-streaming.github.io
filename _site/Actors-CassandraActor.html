<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Coral</title>
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
	<link href='https://fonts.googleapis.com/css?family=Droid+Serif:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
    <script src="/lib/jquery/jquery-1.11.2.min.js"></script>
    <script src="/lib/bootstrap/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="/lib/bootstrap/css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="/css/custom.css" type="text/css">
    <link rel="stylesheet" href="/css/syntax.css" type="text/css">
</head>
<body>
	<div class="header"></div>
	
    <div id="toplinks">
		<div style="height: 35px"><a href="/Documentation-ApiReference.html">API Reference</a></div>
		<div style="height: 35px"><a href="/GettingStarted-Download.html">Download</a></div>
		<div><a href="/">About</a></div>
	</div>
	
    <div class="container">
        <div class="row content">
            <div class="col-md-3 menu" style="text-align: right; margin-left: -150px">
            
            
            	
	                <div class="row">
    	                <div class="col-md-12">
        	                <h3>Overview</h3>
            	        </div>
                	</div>
	                
    	            
        	            
            	            <div class="row">
                	        <div class="col-md-12">
                    	    <a href="/Overview-Architecture.html">
	                        	
                	        			Architecture
                    	    	
							</a>
    	                    </div>
        	                </div>
            	        
                	
        	            
            	            <div class="row">
                	        <div class="col-md-12">
                    	    <a href="/Overview-ActorOverview.html">
	                        	
        	                			Actor Overview
        	                		
							</a>
    	                    </div>
        	                </div>
            	        
                	
        	            
            	            <div class="row">
                	        <div class="col-md-12">
                    	    <a href="/Overview-Technologies.html">
	                        	
                	        			Technologies
                    	    	
							</a>
    	                    </div>
        	                </div>
            	        
                	
        	            
            	            <div class="row">
                	        <div class="col-md-12">
                    	    <a href="/Overview-Roadmap.html">
	                        	
                	        			Roadmap
                    	    	
							</a>
    	                    </div>
        	                </div>
            	        
                	
        	            
            	            <div class="row">
                	        <div class="col-md-12">
                    	    <a href="/Overview-History.html">
	                        	
                	        			History
                    	    	
							</a>
    	                    </div>
        	                </div>
            	        
                	
                	
	            
            	
	                <div class="row">
    	                <div class="col-md-12">
        	                <h3>Getting started</h3>
            	        </div>
                	</div>
	                
    	            
        	            
            	            <div class="row">
                	        <div class="col-md-12">
                    	    <a href="/GettingStarted-Prerequisites.html">
	                        	
                	        			Prerequisites
                    	    	
							</a>
    	                    </div>
        	                </div>
            	        
                	
        	            
            	            <div class="row">
                	        <div class="col-md-12">
                    	    <a href="/GettingStarted-Download.html">
	                        	
                	        			Download
                    	    	
							</a>
    	                    </div>
        	                </div>
            	        
                	
        	            
            	            <div class="row">
                	        <div class="col-md-12">
                    	    <a href="/GettingStarted-HelloWorld.html">
	                        	
                	        			Hello World
                    	    	
							</a>
    	                    </div>
        	                </div>
            	        
                	
        	            
            	            <div class="row">
                	        <div class="col-md-12">
                    	    <a href="/GettingStarted-HelloWorldKafka.html">
	                        	
                	        			Hello World with Kafka
                    	    	
							</a>
    	                    </div>
        	                </div>
            	        
                	
        	            
            	            <div class="row">
                	        <div class="col-md-12">
                    	    <a href="/GettingStarted-Examples.html">
	                        	
                	        			Examples
                    	    	
							</a>
    	                    </div>
        	                </div>
            	        
                	
                	
	            
            	
	                <div class="row">
    	                <div class="col-md-12">
        	                <h3>Documentation</h3>
            	        </div>
                	</div>
	                
    	            
        	            
            	            <div class="row">
                	        <div class="col-md-12">
                    	    <a href="/Documentation-StateCalculation.html">
	                        	
                	        			State calculation
                    	    	
							</a>
    	                    </div>
        	                </div>
            	        
                	
        	            
            	            <div class="row">
                	        <div class="col-md-12">
                    	    <a href="/Documentation-ApiReference.html">
	                        	
                	        			API Reference
                    	    	
							</a>
    	                    </div>
        	                </div>
            	        
                	
        	            
            	            <div class="row">
                	        <div class="col-md-12">
                    	    <a href="/Documentation-ActorReference.html">
	                        	
        	                			Actor Reference
            	            		
							</a>
    	                    </div>
        	                </div>
            	        
                	
        	            
            	            <div class="row">
                	        <div class="col-md-12">
                    	    <a href="/Documentation-CommandLineArguments.html">
	                        	
                	        			Command line parameters
                    	    	
							</a>
    	                    </div>
        	                </div>
            	        
                	
        	            
            	            <div class="row">
                	        <div class="col-md-12">
                    	    <a href="/Documentation-Configuration.html">
	                        	
                	        			Configuration Reference
                    	    	
							</a>
    	                    </div>
        	                </div>
            	        
                	
                	
	            
            	
	                <div class="row">
    	                <div class="col-md-12">
        	                <h3></h3>
            	        </div>
                	</div>
	                
    	            
        	            
                	
        	            
                	
        	            
                	
        	            
                	
        	            
                	
        	            
                	
        	            
                	
        	            
                	
        	            
                	
        	            
                	
        	            
                	
        	            
                	
        	            
                	
        	            
                	
        	            
                	
        	            
                	
        	            
                	
        	            
                	
        	            
                	
        	            
                	
        	            
                	
                	
	            
            	
	            
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
	            <br>
            </div>
            <div class="col-md-7 tableborder" style="margin-top: 50px; ">
                <!--
   Licensed to the Apache Software Foundation (ASF) under one or more
   contributor license agreements.  See the NOTICE file distributed with
   this work for additional information regarding copyright ownership.
   The ASF licenses this file to You under the Apache License, Version 2.0
   (the "License"); you may not use this file except in compliance with
   the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
-->

<h1 id="cassandraactor">CassandraActor</h1>
<p>The <code>CassandraActor</code> is a <a href="/actors/overview/">Coral Actor</a> that enables communication with a Cassandra database.  The actor receives queries in the trigger field and emits the results.
All valid <a href="https://docs.datastax.com/en/cql/3.1/cql/cql_using/about_cql_c.html">CQL</a> queries can be executed, including creating keyspaces and inserting, deleting and updating values.</p>

<div class="alert alert-warning" role="alert">
  <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
  <span class="sr-only">Warning</span>
  <strong>NOTE</strong>:&nbsp;Currently, the CassandraActor cannot be included directly in your runtime. It is meant as a supporting actor to be used by the Coral platform itself. In the future, it might be possible to use the Cassandra Actor to perform queries through a <i>collect</i> procedure. 
</div>

<h2 id="creating-a-cassandraactor">Creating a CassandraActor</h2>

<p>The <code>params</code> value is a JSON object with the following fields:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">field</th>
      <th style="text-align: left">type</th>
      <th style="text-align: left">required</th>
      <th style="text-align: left">description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code>seeds</code></td>
      <td style="text-align: left">List[String]</td>
      <td style="text-align: left">yes</td>
      <td style="text-align: left">A JSON list of the IP addresses of seed nodes.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>keyspace</code></td>
      <td style="text-align: left">String</td>
      <td style="text-align: left">yes</td>
      <td style="text-align: left">The name of the keyspace to connect to initially.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>port</code></td>
      <td style="text-align: left">Int</td>
      <td style="text-align: left">no</td>
      <td style="text-align: left">The port to connect to, when omitted default Cassandra port 9042 is used.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>user</code></td>
      <td style="text-align: left">String</td>
      <td style="text-align: left">no</td>
      <td style="text-align: left">The user name to connect to Cassandra.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>password</code></td>
      <td style="text-align: left">String</td>
      <td style="text-align: left">no</td>
      <td style="text-align: left">The password to connect to Cassandra.</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<p>The CassandraActor can process any valid CQL query. The <code>keyspace</code> will be connected to initially, but it can later be changed by sending the CassandraActor a “use keyspace” statement:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&quot;query&quot;</span><span class="p">:</span> <span class="s2">&quot;use keyspace otherKeyspace;&quot;</span>
<span class="p">}</span></code></pre></figure>

<p><br /></p>

<h4 id="creation-example">Creation example</h4>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;cassandra&quot;</span><span class="p">,</span>
  <span class="nt">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;seeds&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;192.168.0.2&quot;</span><span class="p">,</span> <span class="s2">&quot;192.168.0.3&quot;</span><span class="p">],</span>
    <span class="nt">&quot;keyspace&quot;</span><span class="p">:</span> <span class="s2">&quot;coral&quot;</span><span class="p">,</span>
    <span class="nt">&quot;port&quot;</span><span class="p">:</span> <span class="mi">9042</span><span class="p">,</span>
    <span class="nt">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;admin&quot;</span><span class="p">,</span>
    <span class="nt">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;admin&quot;</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>This will create a CassandraActor connecting to seed nodes 192.168.0.2 and 192.168.0.3 on port 9042, to keyspace “coral”, using user “admin” and password “admin”.</p>

<p><br /></p>

<h2 id="trigger">Trigger</h2>
<p>The <code>CassandraActor</code> receives the CQL statement in the query field of the trigger JSON.</p>

<p><br /></p>

<h4 id="example">Example</h4>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
    <span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="s2">&quot;select * from testkeyspace.test1&quot;</span>
<span class="p">}</span></code></pre></figure>

<p><br /></p>

<h2 id="emit">Emit</h2>

<p>The CassandraActor does not emit its result to other actors, but instead should return the answer only to the caller. Thus, the CassandraActor can only be used with a <i>collect</i> procedure.</p>

<p>The answer that the CassandraActor returns is JSON, and looks as follows:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&quot;seeds&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;192.168.0.1&quot;</span> <span class="p">],</span>
  <span class="nt">&quot;query&quot;</span> <span class="p">:</span> <span class="s2">&quot;select * from keyspace.table&quot;</span><span class="p">,</span>
  <span class="nt">&quot;success&quot;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nt">&quot;data&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">{</span>
    <span class="nt">&quot;field1&quot;</span> <span class="p">:</span> <span class="s2">&quot;66d61c3e-a1a0-46e4-b567-a84a8a052a2d&quot;</span><span class="p">,</span>
    <span class="nt">&quot;field2&quot;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nt">&quot;field3&quot;</span> <span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
    <span class="nt">&quot;field4&quot;</span><span class="p">:</span> <span class="mf">26.73</span>
  <span class="p">}]</span>
<span class="p">}</span></code></pre></figure>

<p>The CassandraActor automatically converts the result of the query into a JSON object. It converts each Cassandra data type to a JSON type as in the following table:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right">Cassandra type</th>
      <th style="text-align: left">JSON type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right"><code>ascii</code></td>
      <td style="text-align: left">JString</td>
    </tr>
    <tr>
      <td style="text-align: right"><code>bigint</code></td>
      <td style="text-align: left">JInt</td>
    </tr>
    <tr>
      <td style="text-align: right"><code>boolean</code></td>
      <td style="text-align: left">JBool</td>
    </tr>
    <tr>
      <td style="text-align: right"><code>int</code></td>
      <td style="text-align: left">JInt</td>
    </tr>
    <tr>
      <td style="text-align: right"><code>decimal</code></td>
      <td style="text-align: left">JDecimal</td>
    </tr>
    <tr>
      <td style="text-align: right"><code>double</code></td>
      <td style="text-align: left">JDouble</td>
    </tr>
    <tr>
      <td style="text-align: right"><code>float</code></td>
      <td style="text-align: left">JDouble</td>
    </tr>
    <tr>
      <td style="text-align: right"><code>text</code></td>
      <td style="text-align: left">JString</td>
    </tr>
    <tr>
      <td style="text-align: right"><code>varchar</code></td>
      <td style="text-align: left">JString</td>
    </tr>
    <tr>
      <td style="text-align: right"><code>varint</code></td>
      <td style="text-align: left">JInt</td>
    </tr>
    <tr>
      <td style="text-align: right"><code>timestamp</code></td>
      <td style="text-align: left">JInt</td>
    </tr>
    <tr>
      <td style="text-align: right"><code>uuid</code></td>
      <td style="text-align: left">JString</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<p>An example of each of these data types is given below:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&quot;seeds&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;192.168.0.1&quot;</span> <span class="p">],</span>
  <span class="nt">&quot;query&quot;</span> <span class="p">:</span> <span class="s2">&quot;select * from keyspace.datatypes&quot;</span><span class="p">,</span>
  <span class="nt">&quot;success&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">[{</span>
    <span class="nt">&quot;ascii&quot;</span><span class="p">:</span> <span class="s2">&quot;some text&quot;</span><span class="p">,</span>
    <span class="nt">&quot;bigint&quot;</span><span class="p">:</span> <span class="mi">156395834234098</span><span class="p">,</span>
    <span class="nt">&quot;boolean&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nt">&quot;int&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
    <span class="nt">&quot;decimal&quot;</span><span class="p">:</span> <span class="mf">5634.34</span><span class="p">,</span>
    <span class="nt">&quot;double&quot;</span><span class="p">:</span> <span class="mf">5634.34</span><span class="p">,</span>
    <span class="nt">&quot;float&quot;</span><span class="p">:</span> <span class="mf">5634.34</span><span class="p">,</span>
    <span class="nt">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;some text&quot;</span><span class="p">,</span>
    <span class="nt">&quot;varchar&quot;</span><span class="p">:</span> <span class="s2">&quot;some text&quot;</span><span class="p">,</span>
    <span class="nt">&quot;varint&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
    <span class="nt">&quot;timestamp&quot;</span><span class="p">:</span> <span class="mi">1451746530</span><span class="p">,</span>
    <span class="nt">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;f0223bb6-dfed-489d-8923-54a250aafe21&quot;</span>
  <span class="p">}]</span>
<span class="p">}</span></code></pre></figure>

<p><br /></p>

<h2 id="state">State</h2>
<p>The <code>CassandraActor</code> returns its state as follows:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">field</th>
      <th style="text-align: left">type</th>
      <th style="text-align: left">description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code>connected</code></td>
      <td style="text-align: left">boolean</td>
      <td style="text-align: left">Whether there is still an active connection to the Cassandra database at the time of collecting the state.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>keyspace</code></td>
      <td style="text-align: left">String</td>
      <td style="text-align: left">The name of the keyspace the actor is currently connected to.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>schema</code></td>
      <td style="text-align: left">Array</td>
      <td style="text-align: left">A JSON representation of the schema of the keyspace currently connected to.</td>
    </tr>
  </tbody>
</table>

<p>An example of a schema is as follows:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&quot;connected&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nt">&quot;keyspace&quot;</span><span class="p">:</span> <span class="s2">&quot;keyspacename&quot;</span><span class="p">,</span>
  <span class="nt">&quot;schema&quot;</span><span class="p">:</span> <span class="p">[{</span>
    <span class="nt">&quot;table1&quot;</span><span class="p">:</span> <span class="p">[</span>
     <span class="p">{</span> <span class="nt">&quot;column1&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span> <span class="p">},</span>
     <span class="p">{</span> <span class="nt">&quot;column2&quot;</span><span class="p">:</span> <span class="s2">&quot;int&quot;</span> <span class="p">},</span>
     <span class="p">{</span> <span class="nt">&quot;column3&quot;</span><span class="p">:</span> <span class="s2">&quot;float&quot;</span> <span class="p">}],</span> 
    <span class="nt">&quot;table2&quot;</span><span class="p">:</span> <span class="p">[</span>
     <span class="p">{</span> <span class="nt">&quot;col1&quot;</span><span class="p">:</span> <span class="s2">&quot;float&quot;</span> <span class="p">},</span>
     <span class="p">{</span> <span class="nt">&quot;col2&quot;</span><span class="p">:</span> <span class="s2">&quot;int&quot;</span> <span class="p">}]</span>
  <span class="p">}]</span>
<span class="p">}</span></code></pre></figure>

<p><br /></p>

<h2 id="collect">Collect</h2>
<p>The <code>CassandraActor</code> does not collect state from other actors.</p>

<p><br /></p>

<h2 id="timer">Timer</h2>
<p>The <code>CassandraActor</code> does not provide timer actions.</p>

            </div>
        </div>
    </div>
    
    <div class="footer"></div>
    <div id="bottomlinks">
    		<div><a href="https://github.com/coral-streaming/coral">GitHub</a></div>
    		<div><a href="https://groups.google.com/d/forum/coral-streaming">Google Groups</a></div>
    		<div><a href="mailto:stevenraemaekers@gmail.com">Contact</a></div>
    		<div><a href="Contribute.html">Contribute</a></div>
    		<div><a href="FAQ.html">FAQ</a></div>
			<br>
    		<br>
    		<div>&copy; 2015-2016 Steven Raemaekers.<br>Website design by Steven Raemaekers.</div>
    		<div>Coral real-time streaming analytics is open source and available under the Apache 2 license.</div>
    </div>
</body>
</html>
